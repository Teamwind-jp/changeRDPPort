# changeRDPPort

本ソフトは、Windowsサーバーリモートデスクトップ環境保守ツールの一つです。
レジストリのrdpポート番号を引数値に変更して再起動します。使用には注意してください。

Windowsサーバーをリモートデスクトップで保守する場合の有効なセキュリティ対策としてファイヤーウォールのrdpポートプロパティのスコープに接続を許可するIPアドレスを指定します。
この設定は、不特定多数からのアタックを防止します。下図は、その設定例です。

![firewall](https://github.com/user-attachments/assets/4db719c9-4dc6-4799-a75b-8f36291d9cc1)


![firewall](http://teamwindmainte3.ddns.net/github/changeRDPPort/changeRDPPort1.jpg)

しかし、このセキュリティ対策は、接続する側のIPアドレスが変わった場合に接続できなくなる問題が発生します。
このソフトは、その問題を解決します。

# Requirement
phpが動作しているWindows上で使用してください。本ソフトを起動する
.net framework4.8を指定しているので適宜変更してください。  

# How It Works

運用中のサーバーでの設定は止めてください。また手元にサーバーがある場合のみ実行してください。
以下手順です。

1.通常ポートと予備のポートの2つを決めて設定する。
rdpの既定ポートは、3389ですが例えば50001にして予備を50002と仮定します。
ファイヤーウォールの設定で3389を閉じて50001と50002を解放します。
ルーターの静的IPマスカレードに50001と50002の2つを登録します。

2.レジストリのrdpポートを50001に変更し再起動します。
[HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp]のPortNumber。

以上で新たに50001を使用してリモートデスクトップ接続が可能になります。



3.本ソフトを任意のフォルダに配置します。
このまま本ソフトを起動するとUAC確認ダイアログが出て止まります。遠隔で中に入れない場合は、これでジエンドです。
UAC確認ダイアログを出さないためにタスクスケジューラに本ソフトを実行させる設定をします

4.管理ツールのタスクスケジューラにて新規スケジュールを







以上で[yourserverドメイン:50001]と指定すると









(Translation by Google)

